.sidebar-white
  .sidebar-content-white
    = "Class min. of #{course.min_seats}"
    - if course.max_seats.present?
      = ", max. of #{course.max_seats}"
    %br
    %br
    - if course.inactive?
      - if course.has_teacher?(current_user)
        %p= "This class has passed."
        = button_to "Teach this again!", new_course_path, :method => :get, :class => "register-class-button"
      - else
        %p= "This class has passed."
        = button_to "Request a new one", new_suggestion_path, :method => :get, :class => "register-class-button"

    - elsif course.sold_out?
      - if course.has_teacher?(current_user)
        = "Yay! Your class is sold out!"
        = button_to "Edit class profile", edit_course_path(:id => course), :method => :get, :class => "edit-class-button"
      - elsif course.has_student?(current_user)
        .edit-class-button= "You're already registered"
      - else
        = "Class is full already!"
        = button_to "Request a new one", new_suggestion_path, :method => :get, :class => "register-class-button"
    - else
      - if course.has_teacher?(current_user)
        = button_to "Edit class profile", edit_course_path(:id => course), :method => :get, :class => "edit-class-button"
      - elsif course.has_student?(current_user)
        .edit-class-button= "You're already registered"
      - else
        - if course.near_user?(current_user)
          - if course.donate?
            = link_to image_tag("v2-campaign/button-register.png"), payment_preview_path(:id => course.id), :method => :put
          - else
            = button_to "Register for this class", payment_preview_path(:id => course.id), :method => :put, :class => "register-class-button"
        - else
          - if course.donate?
            = link_to image_tag("v2-campaign/button-register.png"), payment_preview_path(:id => course.id), :method => :put, :confirm => "You specified your location as #{current_user.city}. This class is in #{course.city.name}! Are you sure you want to register for it?"
          - else
            = button_to "Register for this class", payment_preview_path(:id => course.id), :method => :put, :class => "register-class-button", :confirm => "You specified your location as #{current_user.city}. This class is in #{course.city.name}! Are you sure you want to register for it?"


    .sidebar-block
      %table
        %tr
          %td.icon
            = image_tag "v2/icon_pricetag.png", :class => "class-details-icon-cost"
          %td
            .class-details
              = "$" "#{course.price}"
              %br/
              - if course.has_student?(current_user)
              - else
                - if course.donate?
                  .greendoors-alternatives All proceeds will be used to support the Peer Teaching Fund!
                - else
                  %a.class-alternatives(href="http://bit.ly/rAtf6o") Too much? Suggest a new price!
              %br
        %tr
          %td.icon
            = image_tag "v2/icon_calendar.png", :class => "class-details-icon-when"
          %td
            .class-details
              = course.date.strftime("%a %b %d, %Y")
            .class-sidebar-details
              = "#{course.time_range}"
              %br
            - if course.has_student?(current_user)

            - else
              %a.class-alternatives(href="http://bit.ly/rAtf6o") Can't make it? Request a new time!
              %br/
        %tr
          %td.icon
            = image_tag "v2/icon_location.png", :class => "class-details-icon-where"
          %td
            .class-details
              = course.place_name
            - if course.public?
              .class-sidebar-details
                = course.address
            - else
              = "Private Address"
            - if course.has_student?(current_user)
            - else
              %a.class-alternatives(href="http://bit.ly/rAtf6o") Don't live in this city? Request in yours!
              %br

    - if course.donate?
      .sidebar-block
        = image_tag "v2-campaign/frame.png", :class => "greendoors-frame"
        = link_to image_tag("v2-campaign/button-learnmore.png"), campaign_path, :class => "button-learnmore"
        .greendoors-frame-heading Peer Teaching Fund
        .greendoors-frame-copy
          .greendoors-frame-copy-text This fund is used to cover the cost of a peer teaching program at our partnered non-profit organizations.  


    .sidebar-block-last
      .sidebar-heading Teacher
      .class-attendance-block
        - if course.teacher.photo.present?
          = image_tag(course.teacher.photo.url(:thumb_small))
        - else
          = image_tag "v2/Avatars_04_V1.png", :class => "avatar-medium"
        .class-details
          %a.profile-link
          = link_to "#{course.teacher.name}", course.teacher, :class => "profile-link"
        %p.class-details
          - if course.experience.blank?
            = "#{course.teacher.bio}"
          - else
            = course.experience

      - if course.teacher != current_user
        = image_tag "v2/icon_email.png", :class => "class-details-icon-email"
        = link_to "Contact teacher", contact_teacher_path(:id => course), :class => "contact-link"


    - if course.students.any?
      .sidebar-block-last
        - if course.nosignup.blank?
          .sidebar-heading Students
        - else course.nosignup?
          .sidebar-heading People interested
        .class-attendance-block
          - course.students.each do |student|
            %table
              %tr
                %td
                  = avatar_for(student, :photo_size => :thumb_small, :class => 'notBig', :size => '50x50')
                %td
                  = link_to student.name, student, :class => "profile-link"
            %br

        - if course.has_teacher?(current_user)
          = image_tag "v2/icon_email.png", :class => "class-details-icon-email"
          = link_to "Contact students", contact_all_students_path(:id => course), :class => "contact-link"



- content_for :admin_action do
  = link_to "Feedback form", feedback_path(:id => course)


